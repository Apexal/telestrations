(this["webpackJsonptelestrations-frontend"]=this["webpackJsonptelestrations-frontend"]||[]).push([[0],{36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},40:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){"use strict";n.r(t);var s=n(1),a=n.n(s),r=n(28),i=n.n(r),o=(n(36),n(37),n(13)),c=n(3),l=(n(38),n(5)),u=n(6),d=n(2),h=n(8),b=n(7),m=n(9),p=n.n(m),j=n(14),v=n(29),f={minPlayers:1,serverURL:"telestrations-server.herokuapp.com",thickWidth:10,thinWidth:5,colors:["black","red","green","blue","yellow"]},g=new v.Client("ws://"+f.serverURL),O=null;function y(){return w.apply(this,arguments)}function w(){return(w=Object(j.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===O){e.next=2;break}return e.abrupt("return",O);case 2:return e.next=4,g.joinOrCreate("lobby");case 4:return O=e.sent,e.abrupt("return",O);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){null!==O&&(O.removeAllListeners(),O.leave(),O=null)}var S=null;function k(){return(k=Object(j.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===S){e.next=2;break}throw Error("Game room is not null!");case 2:return x(),e.next=5,g.create("game_room");case 5:return S=e.sent,e.abrupt("return",S);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){return I.apply(this,arguments)}function I(){return(I=Object(j.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(),e.next=3,g.joinById(t);case 3:return S=e.sent,window.localStorage.setItem("lastRoomId",t),window.localStorage.setItem("lastSessionId",S.sessionId),e.abrupt("return",S);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return(P=Object(j.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.localStorage.getItem("lastRoomId"),n=window.localStorage.getItem("lastSessionId"),e.next=4,g.reconnect(t,n);case 4:return S=e.sent,e.abrupt("return",S);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(){return S}function C(){null!==S&&(window.localStorage.removeItem("lastRoomId"),window.localStorage.removeItem("lastSessionId"),S.removeAllListeners(),S.leave(),S=null)}n(40);var N=n(0),M=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return this.props.visible?Object(N.jsx)("div",{children:this.props.children}):Object(N.jsx)(N.Fragment,{})}}]),n}(s.Component),D=n(17),T=n(22),U=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=Object(j.a)(p.a.mark((function e(){var t,n=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:(t=e.sent).onMessage("rooms",(function(e){n.props.onSetPublicRooms(e)})),t.onMessage("+",(function(e){var t=Object(T.a)(e,2),s=t[0],a=t[1],r=n.props.publicRooms.findIndex((function(e){return e.roomId===s}));-1!==r?n.props.onSetPublicRooms(n.props.publicRooms.map((function(e,t){return r===t?a:e}))):n.props.onSetPublicRooms([a].concat(Object(D.a)(n.props.publicRooms)))})),t.onMessage("-",(function(e){n.props.onSetPublicRooms(n.props.publicRooms.filter((function(t){return t.roomId!==e})))}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){x()}},{key:"renderPublicGames",value:function(){return this.props.publicRooms.length<=0?Object(N.jsx)("div",{className:"center",children:Object(N.jsx)("i",{children:"There are no open public rooms!"})}):this.props.publicRooms.map((function(e,t){return Object(N.jsx)("div",{className:"row",children:Object(N.jsxs)(o.b,{to:"/"+e.roomId,className:"button u-full-width",children:["Game ",e.roomId," ",Object(N.jsxs)("span",{className:"u-pull-right",children:["(",e.clients," / ",e.maxClients,")"]})]})},e.roomId)}))}},{key:"render",value:function(){return Object(N.jsx)("div",{className:"panel",children:this.renderPublicGames()})}}]),n}(s.Component),L=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var s;return Object(l.a)(this,n),(s=t.call(this,e)).state={showPublicGames:!1,showPrivateGame:!1,publicRooms:[],canReconnect:null!==window.localStorage.getItem("lastRoomId")},s.handleShowPublicGames=s.handleShowPublicGames.bind(Object(d.a)(s)),s.handleHostGame=s.handleHostGame.bind(Object(d.a)(s)),s.handleSetPublicRooms=s.handleSetPublicRooms.bind(Object(d.a)(s)),s.handleJoinPrivateGame=s.handleJoinPrivateGame.bind(Object(d.a)(s)),s.handleReconnect=s.handleReconnect.bind(Object(d.a)(s)),s}return Object(u.a)(n,[{key:"handleShowPublicGames",value:function(){this.setState({showPublicGames:!this.state.showPublicGames})}},{key:"handleSetPublicRooms",value:function(e){this.setState({publicRooms:e})}},{key:"handleShowPrivateGame",value:function(){this.setState({showPrivateGame:!this.state.showPrivateGame})}},{key:"handleSetPrivateRooms",value:function(e){this.setState({privateRooms:e})}},{key:"handleHostGame",value:function(){var e=this;(function(){return k.apply(this,arguments)})().then((function(t){e.props.history.push("/"+t.id,{isHost:!0})}))}},{key:"handleJoinPrivateGame",value:function(e){e.preventDefault();var t=e.target.roomId.value;this.props.history.push("/"+t),e.target.roomId.value=""}},{key:"handleReconnect",value:function(){var e=this;(function(){return P.apply(this,arguments)})().then((function(t){e.props.history.push("/"+t.id,{isReconnecting:!0})})).catch((function(t){window.alert(t),window.localStorage.removeItem("lastRoomId"),window.localStorage.removeItem("lastSessionId"),e.setState({canReconnect:!1})}))}},{key:"render",value:function(){return Object(N.jsxs)("div",{children:[Object(N.jsx)("h1",{className:"title title-anim",children:"Telestrations"}),Object(N.jsx)("div",{className:"row",children:Object(N.jsx)("button",{className:"button u-full-width",onClick:this.handleHostGame,children:"Host Game"})}),Object(N.jsxs)("div",{className:"row",children:[Object(N.jsx)("button",{className:"button u-full-width",onClick:this.handleShowPublicGames,children:"Join Public Game"}),Object(N.jsx)(M,{visible:this.state.showPublicGames,children:Object(N.jsx)(U,{publicRooms:this.state.publicRooms,onSetPublicRooms:this.handleSetPublicRooms})})]}),Object(N.jsxs)("div",{className:"row",children:[Object(N.jsx)("button",{className:"button u-full-width",onClick:this.handleShowPrivateGame,children:"Join Private Game"}),Object(N.jsx)(M,{visible:this.state.showPrivateGame,children:Object(N.jsx)("form",{onSubmit:this.handleJoinPrivateGame,children:Object(N.jsx)("input",{className:"u-full-width input-view",name:"roomId",type:"text",placeholder:"Code..."})})}),this.state.canReconnect&&Object(N.jsx)("div",{className:"row",children:Object(N.jsx)("button",{className:"button u-full-width",onClick:this.handleReconnect,children:"Reconnect"})})]})]})}}]),n}(s.Component),W=Object(c.f)(L),Y=n(19),X=n(18);n(49);function E(e){var t=e.sessionId,n=e.isPlayer,s=e.isHost,a=e.displayName;return Object(N.jsx)("li",{children:Object(N.jsxs)("div",{className:"player-tag player-tag-add-anim",children:[Object(N.jsxs)("span",{children:[s?"\ud83d\udc51":""," ",a]}),n&&Object(N.jsx)("strong",{style:{marginLeft:5},children:"(You)"})]})},t)}function H(e){var t=e.roomId,n=e.sessionId,s=e.hostPlayerSessionId,a=e.players,r=e.maxPlayers,i=e.onChangeName,c=e.onStartGame,l=e.isPublic,u=e.onToggleRoomVisibility,d=s===n,h=Object.keys(a).length,b=Object.keys(a).map((function(e){return Object(N.jsx)(E,{isPlayer:e===n,isHost:s===e,displayName:a[e].displayName},e)})),m=h<f.minPlayers?Object(N.jsx)("button",{className:"button",disabled:!0,children:"Waiting For Players"}):Object(N.jsx)("button",{className:"button",onClick:c,children:"Start Game"});return Object(N.jsxs)("div",{className:"game-lobby",children:[Object(N.jsx)("div",{className:"supertext center",children:"your room code is..."}),Object(N.jsx)("h1",{className:"title room-code-anim",children:t}),Object(N.jsxs)("h5",{children:[h," / ",r," players"]}),Object(N.jsx)("ul",{children:b}),d?m:Object(N.jsx)(o.b,{className:"button",to:"/",children:"Leave"}),d&&Object(N.jsxs)("button",{className:"button",onClick:u,children:["Make Room ",l?"Private":"Public"]}),a[n]&&Object(N.jsx)("button",{className:"button u-pull-right",onClick:i,children:"Change Name"})]})}var J=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={context:null},a.canvasRef=Object(s.createRef)(),a.drawStroke=a.drawStroke.bind(Object(d.a)(a)),a.draw=a.draw.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"drawStroke",value:function(e){if(e){var t=this.state.context;t.beginPath(),t.moveTo(e.fromX,e.fromY),t.lineTo(e.toX,e.toY),t.lineWidth=e.width,t.strokeStyle=e.color,t.lineCap="round",t.stroke(),t.closePath()}}},{key:"draw",value:function(){var e=this;this.state.context.clearRect(0,0,this.canvasRef.current.clientWidth,this.canvasRef.current.clientHeight);for(var t=function(t){window.setTimeout((function(){return e.drawStroke(e.props.drawingStrokes[t])}),10*t)},n=0;n<this.props.drawingStrokes.length;n++)t(n)}},{key:"componentDidMount",value:function(){this.setState({context:this.canvasRef.current.getContext("2d")},this.draw)}},{key:"componentDidUpdate",value:function(e){e.drawingStrokes.length!==this.props.drawingStrokes.length&&this.draw()}},{key:"render",value:function(){return Object(N.jsx)("canvas",{id:"canvas",ref:this.canvasRef,width:"400",height:"400",children:"Sorry, your browser does not support canvas."})}}]),n}(s.Component),K=n(31);function F(e){var t=e.isSubmitted,n=e.onClear,s=e.onUndo,a=e.onSubmit;return Object(N.jsxs)("div",{children:[Object(N.jsx)("button",{className:"button button-bar",onClick:n,id:"clear",children:"Clear"}),Object(N.jsx)("button",{className:"button button-bar",id:"undo",onClick:s,children:"Undo"}),t?Object(N.jsx)("button",{className:"button button-bar",id:"submit",disabled:!0,children:"Waiting for Other Players"}):Object(N.jsx)("button",{className:"button button-bar",id:"submit",onClick:a,children:"Submit"})]})}var _=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={currentX:-1,currentY:-1,width:5,colorIndex:0,strokes:[],context:null},a.canvasRef=Object(s.createRef)(),a.clear=a.clear.bind(Object(d.a)(a)),a.redraw=a.redraw.bind(Object(d.a)(a)),a.handleClear=a.handleClear.bind(Object(d.a)(a)),a.handleUndo=a.handleUndo.bind(Object(d.a)(a)),a.handleReplay=a.handleReplay.bind(Object(d.a)(a)),a.onDownload=a.onDownload.bind(Object(d.a)(a)),a.drawStroke=a.drawStroke.bind(Object(d.a)(a)),a.onMouseMove=a.onMouseMove.bind(Object(d.a)(a)),a.onMouseClick=a.onMouseClick.bind(Object(d.a)(a)),a.onMouseReleased=a.onMouseReleased.bind(Object(d.a)(a)),a.onTouchMove=a.onTouchMove.bind(Object(d.a)(a)),a.onTouchStart=a.onTouchStart.bind(Object(d.a)(a)),a.handleToggleWidth=a.handleToggleWidth.bind(Object(d.a)(a)),a.handleCycleColor=a.handleCycleColor.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.setState({context:this.canvasRef.current.getContext("2d")}),this.canvasRef.current.addEventListener("mousedown",this.onMouseClick),this.canvasRef.current.addEventListener("mouseup",this.onMouseReleased),this.canvasRef.current.addEventListener("mousemove",this.onMouseMove),this.canvasRef.current.addEventListener("touchmove",this.onTouchMove),this.canvasRef.current.addEventListener("touchstart",this.onTouchStart)}},{key:"drawStroke",value:function(e){var t=this.state.context;t.beginPath(),t.moveTo(e.fromX,e.fromY),t.lineTo(e.toX,e.toY),t.lineWidth=e.width,t.strokeStyle=e.color,t.lineCap="round",t.stroke(),t.closePath()}},{key:"clear",value:function(){this.state.context.clearRect(0,0,this.canvasRef.current.clientWidth,this.canvasRef.current.clientHeight)}},{key:"redraw",value:function(){this.clear();var e,t=Object(K.a)(this.props.drawingStrokes);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.drawStroke(n)}}catch(s){t.e(s)}finally{t.f()}}},{key:"distance",value:function(e,t,n,s){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-s,2))}},{key:"samePos",value:function(e,t,n,s){return e===n&&t===s}},{key:"optimizeStrokes",value:function(e){for(var t=0;t<=2;t++)for(var n=2;n<e.length;n++){var s=e[n],a=e[n-1],r=e[n-2];this.distance(a.fromX,a.fromY,s.fromX,s.fromY)<=5&&this.samePos(r.toX,r.toY,a.fromX,a.fromY)&&(e.splice(n-1,1),r.toX=s.fromX,r.toY=s.fromY)}}},{key:"getMousePos",value:function(e){var t=this.canvasRef.current.getBoundingClientRect();return{x:(e.clientX-t.left)/(t.right-t.left)*this.canvasRef.current.width,y:(e.clientY-t.top)/(t.bottom-t.top)*this.canvasRef.current.height}}},{key:"setCurrentPosition",value:function(e,t){this.setState({currentX:e,currentY:t})}},{key:"onMouseClick",value:function(e){var t=this.getMousePos(e);this.setCurrentPosition(t.x,t.y)}},{key:"onMouseMove",value:function(e){if(e.preventDefault(),e.stopPropagation(),1===e.buttons&&!this.props.isSubmitted){var t=this.getMousePos(e),n={fromX:-1===this.state.currentX?t.x:this.state.currentX,fromY:-1===this.state.currentY?t.y:this.state.currentY,toX:t.x,toY:t.y,width:this.state.width,color:f.colors[this.state.colorIndex]},s=this.props.drawingStrokes.concat(n);this.props.onDrawingStrokesUpdate(s),this.drawStroke(n),this.setCurrentPosition(t.x,t.y)}}},{key:"onMouseReleased",value:function(){var e=Object(D.a)(this.props.drawingStrokes);this.optimizeStrokes(e),this.props.onDrawingStrokesUpdate(e),this.redraw()}},{key:"onTouchMove",value:function(e){e.preventDefault();var t=e.touches[0],n=new window.MouseEvent("mousemove",{clientX:t.clientX,clientY:t.clientY,buttons:1});this.canvasRef.current.dispatchEvent(n)}},{key:"onTouchStart",value:function(e){e.preventDefault();var t=this.getMousePos(e.touches[0]);this.setCurrentPosition(t.x,t.y)}},{key:"handleToggleWidth",value:function(){this.setState({width:this.state.width===f.thinWidth?f.thickWidth:f.thinWidth})}},{key:"handleCycleColor",value:function(){this.setState({colorIndex:(this.state.colorIndex+1)%f.colors.length})}},{key:"handleClear",value:function(){this.clear(),this.props.onDrawingStrokesUpdate([])}},{key:"handleUndo",value:function(){if(0!==this.props.drawingStrokes.length){for(var e=this.props.drawingStrokes,t=0;t<5;t++)e.pop();this.props.onDrawingStrokesUpdate(e,this.redraw)}}},{key:"handleReplay",value:function(){var e=this;this.clear();for(var t=[],n=function(n){t.push(setTimeout((function(){return e.drawStroke(e.props.drawingStrokes[n])}),10*n))},s=0;s<this.props.drawingStrokes.length;s++)n(s)}},{key:"onDownload",value:function(){var e=this.state.context.canvas.toDataURL("image/png").replace("image/png","image/octet-stream");window.location.href=e}},{key:"render",value:function(){var e={width:2*this.state.width,height:2*this.state.width,backgroundColor:f.colors[this.state.colorIndex]};return Object(N.jsxs)("div",{children:[Object(N.jsxs)("div",{children:[Object(N.jsxs)("button",{className:"button",onClick:this.handleToggleWidth,children:[this.state.width===f.thickWidth?Object(N.jsx)("strong",{className:"thick-stroke",children:"Thick"}):"Thin"," Stroke"]}),Object(N.jsx)("button",{className:"button",onClick:this.handleCycleColor,children:Object(N.jsx)("div",{className:"color-preview",style:e})})]}),Object(N.jsx)("canvas",{id:"canvas",ref:this.canvasRef,width:"400",height:"400",children:"Sorry, your browser does not support canvas."}),Object(N.jsx)(F,{isSubmitted:this.props.isSubmitted,onClear:this.handleClear,onUndo:this.handleUndo,onSubmit:this.props.onSubmit})]})}}]),n}(s.Component),A=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var s;return Object(l.a)(this,n),(s=t.call(this,e)).handlePreviousDrawingGuessFormSubmit=s.handlePreviousDrawingGuessFormSubmit.bind(Object(d.a)(s)),s}return Object(u.a)(n,[{key:"handlePreviousDrawingGuessFormSubmit",value:function(e){e.preventDefault(),this.props.onPreviousDrawingGuessUpdate(e.currentTarget.guess.value.trim())}},{key:"handleTimer",value:function(e){var t=Math.floor(e/60),n=e-60*t;return t>0?Object(N.jsxs)("span",{children:[Object(N.jsx)("b",{children:t})," minute",1===t?"":"s",", ",Object(N.jsx)("b",{children:n})," second",1===n?"":"s"]}):Object(N.jsxs)("span",{children:[Object(N.jsx)("b",{children:n})," second",1===n?"":"s"]})}},{key:"render",value:function(){var e=this,t=Object(N.jsx)(_,{isSubmitted:this.props.isSubmitted,drawingStrokes:this.props.drawingStrokes,onDrawingStrokesUpdate:this.props.onDrawingStrokesUpdate,onSubmit:this.props.onSubmit});if(1===this.props.roundIndex)return Object(N.jsxs)("div",{className:"center",children:[Object(N.jsx)("h4",{children:"Your word to draw is..."}),Object(N.jsx)("h1",{className:"title scale-in secret-word",children:this.props.secretWord}),Object(N.jsxs)("p",{className:"timer",children:["\u23f0 ",this.handleTimer(this.props.roundTimerSecondsRemaining)," remaining"]}),t]});if(this.props.isDrawingStage)return Object(N.jsxs)("div",{className:"center",children:[Object(N.jsxs)("h1",{className:"title",children:["Draw - Round ",this.props.roundIndex]}),Object(N.jsxs)("p",{className:"timer",children:["\u23f0 ",this.handleTimer(this.props.roundTimerSecondsRemaining)," remaining"]}),Object(N.jsxs)("div",{children:["You guessed ",Object(N.jsx)("strong",{className:"fancy",children:this.props.previousDrawingGuess}),". Now draw your own sketch of it!"]}),t]});var n=(this.props.playerKeys.findIndex((function(t){return t===e.props.sessionId}))+1)%this.props.playerKeys.length,s=this.props.playerKeys[n],a=this.props.players[s],r=a.submissions.find((function(t){return t.roundIndex===e.props.roundIndex-1}));if(!r)return Object(N.jsx)("div",{className:"center",children:Object(N.jsx)("h1",{children:"Collecting player drawings..."})});var i=r.drawingStrokes;return Object(N.jsxs)("div",{className:"center",children:[Object(N.jsxs)("h1",{children:["Guess - Round ",this.props.roundIndex]}),Object(N.jsxs)("p",{className:"timer",children:["\u23f0 ",this.handleTimer(this.props.roundTimerSecondsRemaining)," remaining"]}),Object(N.jsxs)("div",{children:[Object(N.jsxs)("b",{children:[a.displayName," just drew this... masterpiece."]}),Object(N.jsx)("br",{}),Object(N.jsx)(J,{drawingStrokes:i})]}),Object(N.jsxs)("form",{onSubmit:this.handlePreviousDrawingGuessFormSubmit,children:[Object(N.jsx)("span",{children:"Guess what it is below!"}),Object(N.jsx)("div",{children:Object(N.jsx)("input",{className:"center",type:"text",placeholder:"What is this a drawing of?",name:"guess",required:!0})})]})]})}}]),n}(s.Component);function V(e){var t=function(t,n){for(var s=[],a=e.playerKeys.findIndex((function(e){return e===t})),r=function(t){var n=a-t+1;n<0&&(n=e.playerKeys.length-Math.abs(n));var r=e.players[e.playerKeys[n]],i=r.submissions.find((function(e){return e.roundIndex===t}));s.push(Object(N.jsxs)("div",{className:"submission",children:[1===t?Object(N.jsx)("p",{children:"And they first drew..."}):Object(N.jsxs)("p",{children:["Then, ",Object(N.jsx)("strong",{children:r.displayName})," guessed and drew..."]}),Object(N.jsx)(J,{drawingStrokes:i.drawingStrokes}),Object(N.jsx)("h2",{className:"title label",children:i.previousDrawingGuess})]},a+"-"+t))},i=1;i<=e.playerKeys.length+e.playerKeys.length%2;i++)r(i);return Object(N.jsx)("div",{children:s})};return Object(N.jsxs)("div",{className:"game-lobby",children:[Object(N.jsx)("h1",{className:"title room-code-anim",children:"Game Over"}),Object(N.jsx)("h3",{className:"fancy center",children:"Check out the crazy drawing chains!"}),Object.entries(e.players).map((function(e){var n=Object(T.a)(e,2),s=n[0],a=n[1];return Object(N.jsx)("div",{className:"drawing-chain",children:Object(N.jsxs)("details",{children:[Object(N.jsxs)("summary",{children:[Object(N.jsx)("strong",{children:a.displayName}),"'s secret word was ",Object(N.jsx)("span",{className:"title",children:a.secretWord})]}),t(s)]})},s)})),Object(N.jsx)(o.b,{className:"button",to:"/",children:"Home"})]})}n(50);var B=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(N.jsxs)("div",{className:"",children:[Object(N.jsx)("h1",{children:this.props.title}),this.props.children,Object(N.jsx)(o.b,{className:"button",to:"/",children:"Home"}),Object(N.jsx)("a",{href:"https://github.com/Apexal/telestrations/issues/new",target:"_blank",rel:"noreferrer",className:"button",children:"Report Bug"})]})}}]),n}(s.Component),z=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var s;return Object(l.a)(this,n),(s=t.call(this,e)).state={sessionId:"",roomId:"",isJoiningGame:!0,isInGame:!1,isStateLoaded:!1,hostPlayerSessionId:"",errorMessage:null,maxPlayers:1,players:{},playerKeys:[],roundIndex:0,roundTimerSecondsRemaining:0,previousDrawingGuess:"",drawingStrokes:[],isDrawingStage:!1,isGameOver:!1,isPublic:!0},s.getGameRoomId=s.getGameRoomId.bind(Object(d.a)(s)),s.setupGameRoomEventListeners=s.setupGameRoomEventListeners.bind(Object(d.a)(s)),s.handleChangeName=s.handleChangeName.bind(Object(d.a)(s)),s.handleStartGame=s.handleStartGame.bind(Object(d.a)(s)),s.handleDrawingStrokesUpdate=s.handleDrawingStrokesUpdate.bind(Object(d.a)(s)),s.handlePreviousDrawingGuessUpdate=s.handlePreviousDrawingGuessUpdate.bind(Object(d.a)(s)),s.handleSubmit=s.handleSubmit.bind(Object(d.a)(s)),s.handleToggleRoomVisibility=s.handleToggleRoomVisibility.bind(Object(d.a)(s)),s}return Object(u.a)(n,[{key:"getGameRoomId",value:function(){return this.props.match.params.roomCode}},{key:"getPlayer",value:function(){return this.state.players[this.state.sessionId]}},{key:"isSubmitted",value:function(){var e=this;return!!this.getPlayer().submissions.find((function(t){return t.roundIndex===e.state.roundIndex}))}},{key:"setupGameRoomEventListeners",value:function(){var e=this,t=G();t.onMessage("error",window.alert),t.onMessage("send-submissions",this.handleSubmit),t.onMessage("round-end",(function(){e.setState({drawingStrokes:[],previousDrawingGuess:"",isDrawingStage:!1})})),t.onStateChange.once((function(t){e.setState({isStateLoaded:!0})})),t.state.onChange=function(t){t.forEach((function(t){["hostPlayerSessionId","maxPlayers","roundIndex","isGameOver","roundTimerSecondsRemaining","isPublic"].includes(t.field)&&e.setState(Object(X.a)({},t.field,t.value))}))},t.state.players.onAdd=function(t,n){e.setState((function(e){return{players:Object(Y.a)(Object(Y.a)({},e.players),{},Object(X.a)({},n,t)),playerKeys:[].concat(Object(D.a)(e.playerKeys),[n])}})),t.onChange=function(s){e.setState((function(e){return{players:Object(Y.a)(Object(Y.a)({},e.players),{},Object(X.a)({},n,t))}}))}},t.state.players.onRemove=function(t,n){var s=Object.assign({},e.state.players);delete s[n],e.setState({players:s,playerKeys:e.state.playerKeys.filter((function(e){return e!==n}))})},t.onLeave((function(t){window.alert("Lost connection to the game room..."),C(),e.props.history.push("/")})),t.onError((function(e,t){console.log(e,t),window.alert(e,t)}))}},{key:"handleChangeName",value:function(){var e=window.prompt("New name?");G().send("player_set_displayName",{displayName:e})}},{key:"handleStartGame",value:function(){G().send("start_game")}},{key:"handleDrawingStrokesUpdate",value:function(e,t){this.isSubmitted()||this.setState({drawingStrokes:e},t)}},{key:"handlePreviousDrawingGuessUpdate",value:function(e){this.setState({previousDrawingGuess:e,isDrawingStage:!0})}},{key:"handleSubmit",value:function(){G().send("player_submit_submission",{roundIndex:this.state.roundIndex,previousDrawingGuess:this.state.previousDrawingGuess,drawingStrokes:this.state.drawingStrokes})}},{key:"handleToggleRoomVisibility",value:function(){G().send("set_room_visibility",{isPublic:!this.state.isPublic})}},{key:"componentDidMount",value:function(){var e=Object(j.a)(p.a.mark((function e(){var t,n,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getGameRoomId(),this.setState({roomId:t}),!this.props.location.state||!this.props.location.state.isHost&&!this.props.location.state.isReconnecting){e.next=7;break}null===(n=G())?this.setState({sessionId:"",isJoiningGame:!1,isInGame:!1,errorMessage:"Failed to find or join game room!"}):this.setState({sessionId:n.sessionId,isInGame:!0,isJoiningGame:!1,isHost:n.sessionId===n.state.hostPlayerSessionId,errorMessage:null},this.setupGameRoomEventListeners),e.next=18;break;case 7:return e.prev=7,e.next=10,R(t);case 10:s=e.sent,this.setState({sessionId:s.sessionId,isJoiningGame:!1,isInGame:!0,isHost:!1,errorMessage:null},this.setupGameRoomEventListeners),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(7),console.error(e.t0),this.setState({sessionId:"",isJoiningGame:!1,isInGame:!1,errorMessage:"Failed to find or join game room!"});case 18:case"end":return e.stop()}}),e,this,[[7,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){C()}},{key:"renderGameComponent",value:function(){if(this.state.isInGame){if(0===this.state.roundIndex)return Object(N.jsx)(H,{roomId:this.state.roomId,isPublic:this.state.isPublic,sessionId:this.state.sessionId,hostPlayerSessionId:this.state.hostPlayerSessionId,players:this.state.players,maxPlayers:this.state.maxPlayers,onDrawingStrokesUpdate:this.handleDrawingStrokesUpdate,onChangeName:this.handleChangeName,onStartGame:this.handleStartGame,onToggleRoomVisibility:this.handleToggleRoomVisibility});if(this.state.isGameOver)return Object(N.jsx)(V,{playerKeys:this.state.playerKeys,players:this.state.players});if(this.state.roundIndex>0)return Object(N.jsx)(A,Object(Y.a)({isSubmitted:this.isSubmitted(),secretWord:this.getPlayer().secretWord,onSubmit:this.handleSubmit,onDrawingStrokesUpdate:this.handleDrawingStrokesUpdate,onPreviousDrawingGuessUpdate:this.handlePreviousDrawingGuessUpdate},this.state))}}},{key:"render",value:function(){return Object(N.jsxs)("div",{children:[this.state.isJoiningGame&&Object(N.jsx)("div",{children:"Joining game room..."}),this.state.isInGame&&this.state.isStateLoaded&&this.renderGameComponent(),this.state.errorMessage&&Object(N.jsx)(B,{title:"An Error Occurred",children:Object(N.jsx)("p",{children:this.state.errorMessage})})]})}}]),n}(s.Component),q=Object(c.f)(z);function Q(){var e=[360*Math.random(),50+50*Math.random(),80+15*Math.random()];document.body.style.backgroundColor=function(e){return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"}(e)}var Z=function(){return Q(),Object(N.jsx)("div",{className:"App container",children:Object(N.jsx)(o.a,{children:Object(N.jsxs)(c.c,{children:[Object(N.jsx)(c.a,{path:"/",exact:!0,children:Object(N.jsx)(W,{})}),Object(N.jsx)(c.a,{path:"/:roomCode",children:Object(N.jsx)(q,{})})]})})})},$=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,52)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),s(e),a(e),r(e),i(e)}))};i.a.render(Object(N.jsx)(a.a.StrictMode,{children:Object(N.jsx)(Z,{})}),document.getElementById("root")),$()}},[[51,1,2]]]);
//# sourceMappingURL=main.7cb272ed.chunk.js.map